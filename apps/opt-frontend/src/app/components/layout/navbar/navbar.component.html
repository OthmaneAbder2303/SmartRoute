<!-- Ajout de #navbarRef ici -->
<div
  class="navbar fixed top-0 left-0 w-full bg-gray-100 shadow-md px-3 z-30 transition-all duration-300"
  [ngClass]="{ 'h-[100px] py-4': !isScrolled, 'h-[70px] py-2': isScrolled }"
>
  <!-- Start: Logo -->
  <div class="navbar-start">
    <a routerLink="/" class="block">
      <img
        ngSrc="/assets/logo_zoomed.png"
        alt="SmartRoute Logo"
        class="w-20 h-20 object-contain"
        height="500"
        width="500"
      />
    </a>
  </div>

  <!-- Center: Navigation Menu -->
  <div class="navbar-center">
    <ul class="menu menu-horizontal px-1 space-x-4">
      <li>
        <a routerLink="/" class="text-textBlack hover:text-orange-500 font-semibold">Accueil</a>
      </li>

      <!-- Services -->
      <li class="relative">
        <button
          (click)="toggleMenu('services')"
          class="flex items-center gap-2 text-textBlack hover:text-orange-500 font-semibold focus:outline-none"
        >
          Services
          <svg
            [ngClass]="{ 'rotate-180': isServicesOpen }"
            class="w-4 h-4 transition-transform duration-200"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </button>

        <div
          *ngIf="isServicesOpen"
          class="z-30 bg-white shadow-lg rounded-md p-6 mt-2 absolute top-full left-1/2 -translate-x-1/2 w-[90vw] max-w-5xl flex-wrap gap-6 justify-center flex"
        >
          <ng-container *ngFor="let feature of features">
            <div class="flex items-start space-x-3 p-4 w-[250px]">
              <img [src]="feature.icon" [alt]="feature.title" class="w-8 h-8" />
              <div>
                <a [routerLink]="feature.link" class="font-semibold text-textBlack">{{ feature.title }}</a>
                <p class="text-gray-600 text-sm">{{ feature.shortDescription }}</p>
              </div>
            </div>
          </ng-container>

          <div class="w-full text-center mt-6">
            <a
              routerLink="/services"
              class="bg-orange-500 text-white font-semibold py-3 px-6 rounded-md hover:bg-orange-600"
            >
              Voir tous les services
            </a>
          </div>
        </div>
      </li>

      <!-- Tarifs -->
      <li>
        <a routerLink="/pricing" class="text-textBlack hover:text-orange-500 font-semibold">Tarifs</a>
      </li>

      <!-- Ressources -->
      <li class="relative">
        <button
          (click)="toggleMenu('ressources')"
          class="text-textBlack hover:text-orange-500 font-semibold flex items-center gap-2"
        >
          Ressources
          <svg
            [ngClass]="{ 'rotate-180': isRessourcesOpen }"
            class="w-4 h-4 transition-transform duration-200"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </button>

        <ul
          *ngIf="isRessourcesOpen"
          class="z-30 bg-white shadow-lg rounded-md p-2 mt-2 absolute top-full left-1/2 -translate-x-1/2 w-[200px]"
        >
          <li>
            <a routerLink="/docs" class="block text-gray-700 hover:bg-orange-200 px-4 py-2 rounded-md">Docs</a>
          </li>
          <li>
            <a routerLink="/api" class="block text-gray-700 hover:bg-orange-200 px-4 py-2 rounded-md">API</a>
          </li>
        </ul>
      </li>
    </ul>
  </div>

  <!-- End: Login & Sign-in Icons -->
  <div class="navbar-end flex items-center space-x-4">
    <!-- User is authenticated -->
    <div *ngIf="isAuthenticated" class="flex items-center">
      <div class="mr-3">
        <p class="text-sm text-gray-600">Bienvenue</p>
        <p class="text-primary font-semibold">{{ userFullName }}</p>
      </div>
      <button
        (click)="auth.logout()"
        class="p-2 transition-all duration-200 hover:-translate-y-1"
        aria-label="Déconnexion"
        title="Déconnexion"
      >
        <fa-icon [icon]="['fas', 'sign-out-alt']" class="text-textBlack hover:text-orange-500 text-lg"></fa-icon>
      </button>
    </div>

    <!-- User is not authenticated -->
    <div *ngIf="!isAuthenticated" class="flex items-center space-x-4">
      <a
        routerLink="/Profile"
        class="p-2 transition-all duration-200 hover:-translate-y-1"
      >
        <fa-icon [icon]="['fas', 'user-tie']" class="text-textBlack hover:text-orange-500 text-lg"></fa-icon>
      </a>
      <a
        routerLink="/login"
        class="p-2 transition-all duration-200 hover:-translate-y-1"
        aria-label="Se connecter"
        title="Se connecter"
      >
        <fa-icon [icon]="['fas', 'user']" class="text-textBlack hover:text-orange-500 text-lg"></fa-icon>
      </a>
      <a
        routerLink="/signup"
        class="p-2 transition-all duration-200 hover:-translate-y-1"
        aria-label="S'inscrire"
        title="S'inscrire"
      >
        <fa-icon [icon]="['fas', 'user-plus']" class="text-textBlack hover:text-orange-500 text-lg"></fa-icon>
      </a>
    </div>
  </div>
</div>
